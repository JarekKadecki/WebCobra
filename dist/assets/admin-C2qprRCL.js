import{r as e,j as t,c as n,R as s}from"./client-CDWfY-s5.js";/* empty css              */import"./phaser-DZy_kcLU.js";const a=({selectCallback:n})=>{const[s,a]=e.useState([]);return e.useEffect((()=>{(async()=>{const e=await await fetch("/api/get_studies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})}),t=await e.json();console.log(`recived studies: ${JSON.stringify(t)}.`),a(t)})()}),[]),t.jsxs("select",{onChange:e=>n(e.target.value),defaultValue:"",children:[t.jsx("option",{value:"",disabled:!0,children:"Select study"}),s.map((e=>t.jsx("option",{value:e,children:e},e)))]})},o=()=>{const[n,s]=e.useState(""),[o,i]=e.useState("");return t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),o){if("add"==o){const e={study:document.getElementById("addStudyInput").value};try{const t=await fetch("/api/add_study",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});console.log(`Study ${e.study} sent to be added.`),t.ok&&alert(`Study ${e.study} sent to be added.`)}catch(t){console.error("add_study failed:",t),alert("Submission failed.")}}if("remove"==o){const e={study:n};try{await fetch("/api/remove_study",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),console.log(`Study ${n} sent to be removed.`)}catch(t){console.error("remove_study failed:",t),alert("Submission failed.")}}}else alert("Select a study to add or to remove.")},children:[t.jsx("button",{type:"button",onClick:()=>i("add"),children:"Add Study"}),t.jsx("button",{type:"button",onClick:()=>i("remove"),children:"Remove Study"}),t.jsx("br",{}),"add"==o&&t.jsxs(t.Fragment,{children:[t.jsx("label",{children:"Select name of new study"}),t.jsx("br",{}),t.jsx("input",{type:"text",id:"addStudyInput"}),t.jsx("br",{})]}),"remove"==o&&t.jsxs(t.Fragment,{children:[t.jsx("label",{children:"Select study to remove "}),t.jsx("br",{}),t.jsx(a,{selectCallback:s}),t.jsx("br",{})]}),o&&t.jsx("button",{type:"submit",children:"Submit"})]})},i=({study:n,editionField:s,updateOnSubmit:a,api:o})=>{const[i,r]=e.useState("");let d="?";switch(o){case"/api/get_configuration":d="Configuration";break;case"/api/get_questions":d="Questions";break;case"/api/get_raport":d="Raport";break;default:d="?"}return t.jsx("button",{type:"button",onClick:async()=>{a();try{const e=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({study:n})});if(!e.ok)throw new Error("API request failed");const t=await e.json(),a=JSON.stringify(t,null,2);document.getElementById(s).value="",document.getElementById(s).value=a,r(a)}catch(e){console.error("Error fetching data:",e)}},children:d})},r=()=>{const[n,s]=e.useState(""),[o,r]=e.useState(""),[d,l]=e.useState(""),[c,u]=e.useState(""),y="editionArea",b=e=>()=>{r(`/api/set_${e}`),l(e)};return t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!d||!n)return void alert(`Select a study ${n} and an action ${d} before submitting.`);const t={study:n,fieldToUpdate:d,value:c},s=await fetch("/api/set_questions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(s.ok)document.getElementById("errorMessage").innerHTML="";else{const e=await s.text();console.error("Submission failed:",e),document.getElementById("errorMessage").innerHTML=e}s.ok&&alert("Changes submitted")},children:[t.jsx(a,{selectCallback:s}),t.jsx("br",{}),n&&t.jsxs(t.Fragment,{children:[t.jsx(i,{study:n,editionField:y,updateOnSubmit:b("configuration"),api:"/api/get_configuration"}),t.jsx(i,{study:n,editionField:y,updateOnSubmit:b("questions"),api:"/api/get_questions"}),t.jsx("br",{}),t.jsx("label",{id:"errorMessage"}),t.jsx("textarea",{id:y,value:c,onChange:e=>u(e.target.value),rows:12,style:{width:"100%",marginTop:"1em"}}),t.jsx("br",{}),d&&t.jsxs(t.Fragment,{children:[t.jsxs("label",{children:["Changing ",t.jsx("b",{children:d})," of ",t.jsx("b",{children:n}),"."]}),t.jsx("br",{})]}),t.jsx("button",{type:"submit",children:"Edit data"})]})]})},d=()=>{const[n,s]=e.useState(""),[o,i]=e.useState(0);return t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!n)return void alert("Select a study to generate keys.");if(!o||Number(o)<=0)return void alert("Select number of keys to generate.");const t={number:o,study:n},s=await fetch("/api/generate_keys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log(`Generating ${o} keys for ${n}.`),s.ok){const e=await fetch("/api/get_keys",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=(await e.json()).join("\n"),s=new Blob([n],{type:"text/plain"}),a=URL.createObjectURL(s),o=document.createElement("a");o.href=a,o.download="keys.txt",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}else s.ok||(console.error("generate_keys failed:",err),alert("Submission failed."))},children:[t.jsx("label",{children:"Select study"}),t.jsx("br",{}),t.jsx(a,{selectCallback:s}),t.jsx("br",{}),t.jsx("label",{children:"Provide number o keys to generate"}),t.jsx("br",{}),t.jsx("input",{type:"number",id:"numberInput",onChange:e=>i(Number(e.target.value)),min:"0"}),t.jsx("br",{}),t.jsx("button",{type:"submit",children:"Submit"})]})},l=()=>{const[n,s]=e.useState();return t.jsxs(t.Fragment,{children:[t.jsxs("div",{id:"leftAdminPanel",children:[t.jsx("label",{children:"Choose panel"}),t.jsxs("div",{children:[t.jsx("button",{class:"leftAdminPanelButtons",onClick:()=>s("addRemove"),children:"Add/Remove study"}),t.jsx("br",{}),t.jsx("button",{class:"leftAdminPanelButtons",onClick:()=>s("edit"),children:"Edit study"}),t.jsx("br",{}),t.jsx("button",{class:"leftAdminPanelButtons",onClick:()=>s("generateKeys"),children:"Generate keys"}),t.jsx("br",{})]})]}),t.jsxs("div",{id:"centralAdminPanel",children:["addRemove"==n&&t.jsx(o,{}),"edit"==n&&t.jsx(r,{}),"generateKeys"==n&&t.jsx(d,{})]})]})};n.createRoot(document.getElementById("root")).render(t.jsx(s.StrictMode,{children:t.jsx(l,{})}));
